import{stringify as e}from"querystring";import t from"bottleneck";import r from"isomorphic-fetch";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(r,!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,r){return(d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var o=[null];o.push.apply(o,t);var n=new(Function.bind.apply(e,o));return r&&m(n,r.prototype),n}).apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return d(e,arguments,f(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),m(o,e)})(e)}function p(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var h=function(e){var r=e.concurrency,o=void 0===r?1:r,n=e.maxRequests,i=e.requestLimitInterval;return new t({maxConcurrent:o,minTime:i/n,reservoir:n,reservoirRefreshAmount:n,reservoirRefreshInterval:i})},y=function(e){function t(){var e;return n(this,t),(e=p(this,f(t).call(this))).name="AuthError",e.message="Unauthorized",e.statusCode=401,e}return u(t,l(Error)),t}(),g=function(e){function t(e){var r;return n(this,t),(r=p(this,f(t).call(this))).name="DiscogsError",r.message=e.message,r.statusCode=e.statusCode,r}return u(t,l(Error)),t}(),b=["USD","GBP","EUR","CAD","AUD","JPY","CHF","MXN","BRL","NZD","SEK","ZAR"],w=["Mint (M)","Near Mint (NM or M-)","Very Good Plus (VG+)","Very Good (VG)","Good Plus (G+)","Good (G)","Fair (F)","Poor (P)"],v=["Mint (M)","Near Mint (NM or M-)","Very Good Plus (VG+)","Very Good (VG)","Good Plus (G+)","Good (G)","Fair (F)","Poor (P)","Generic","Not Graded","No Cover"],P=["New Order","Buyer Contacted","Invoice Sent","Payment Pending","Payment Received","Shipped","Refund Sent","Cancelled (Non-Paying Buyer)","Cancelled (Item Unavailable)","Cancelled (Per Buyer's Request)"],j=["All","New Order","Buyer Contacted","Invoice Sent","Payment Pending","Payment Received","Shipped","Merged","Order Changed","Refund Sent","Cancelled","Cancelled (Non-Paying Buyer)","Cancelled (Item Unavailable)","Cancelled (Per Buyer's Request)","Cancelled (Refund Received)"],T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.page,r=void 0===t?1:t,o=e.perPage,n=void 0===o?50:o;if("number"!=typeof r)throw new TypeError("[Paginate] page must be a number (".concat(r,")"));if("number"!=typeof n)throw new TypeError("[Paginate] perPage must be a number (".concat(n,")"));var i={page:r,per_page:n};return r<=0&&(i.page=1),(n<=0||n>100)&&(i.per_page=50),i},E=["release","master","artist","label"];var M=["asc","desc"],F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.by,r=e.order,o=arguments.length>1?arguments[1]:void 0;if(!Array.isArray(o)||Array.isArray(o)&&o.length<1)throw new TypeError("[Sort] sortFields must be a non-empty array");return{sort:o.includes(t)?t:o[0],sort_order:M.includes(r)?r:M[0]}},O=["year","title","format"];var _=Object.freeze({searchDatabase:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.query,r=e.type,o=e.title,n=e.releaseTitle,i=e.credit,s=e.artist,a=e.anv,u=e.label,f=e.genre,m=e.style,d=e.country,l=e.year,p=e.format,h=e.catno,y=e.barcode,g=e.track,b=e.submitter,w=e.contributor,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},P={};if(t){if("string"!=typeof t)return Promise.reject(new TypeError("[searchDatabaseMethod] query must be a string (".concat(t,")")));P.q=t}if(r){if(!E.includes(r))return Promise.reject(new TypeError("[searchDatabaseMethod] type must be one of '".concat(E.join(" / "),"' (").concat(r,")")));P.type=r}if(o){if("string"!=typeof o)return Promise.reject(new TypeError("[searchDatabaseMethod] title must be a string (".concat(o,")")));P.title=o}if(n){if("string"!=typeof n)return Promise.reject(new TypeError("[searchDatabaseMethod] releaseTitle must be a string (".concat(n,")")));P.release_title=n}if(i){if("string"!=typeof i)return Promise.reject(new TypeError("[searchDatabaseMethod] credit must be a string (".concat(i,")")));P.credit=i}if(s){if("string"!=typeof s)return Promise.reject(new TypeError("[searchDatabaseMethod] artist must be a string (".concat(s,")")));P.artist=s}if(a){if("string"!=typeof a)return Promise.reject(new TypeError("[searchDatabaseMethod] anv must be a string (".concat(a,")")));P.anv=a}if(u){if("string"!=typeof u)return Promise.reject(new TypeError("[searchDatabaseMethod] label must be a string (".concat(u,")")));P.label=u}if(f){if("string"!=typeof f)return Promise.reject(new TypeError("[searchDatabaseMethod] genre must be a string (".concat(f,")")));P.genre=f}if(m){if("string"!=typeof m)return Promise.reject(new TypeError("[searchDatabaseMethod] style must be a string (".concat(m,")")));P.style=m}if(d){if("string"!=typeof d)return Promise.reject(new TypeError("[searchDatabaseMethod] country must be a string (".concat(d,")")));P.country=d}if(l){if("string"!=typeof l&&"number"!=typeof l)return Promise.reject(new TypeError("[searchDatabaseMethod] year must be a string or a number (".concat(l,")")));P.year=l}if(p){if("string"!=typeof p)return Promise.reject(new TypeError("[searchDatabaseMethod] format must be a string (".concat(p,")")));P.format=p}if(h){if("string"!=typeof h)return Promise.reject(new TypeError("[searchDatabaseMethod] catno must be a string (".concat(h,")")));P.catno=h}if(y){if("string"!=typeof y)return Promise.reject(new TypeError("[searchDatabaseMethod] barcode must be a string (".concat(y,")")));P.barcode=y}if(g){if("string"!=typeof g)return Promise.reject(new TypeError("[searchDatabaseMethod] track must be a string (".concat(g,")")));P.track=g}if(b){if("string"!=typeof b)return Promise.reject(new TypeError("[searchDatabaseMethod] submitter must be a string (".concat(b,")")));P.submitter=b}if(w){if("string"!=typeof w)return Promise.reject(new TypeError("[searchDatabaseMethod] contributor must be a string (".concat(w,")")));P.contributor=w}return this._fetch({uri:"/database/search",query:c({},P,{},T(v))})},getRelease:function(e,t){if("number"!=typeof e)return Promise.reject(new TypeError("[getReleaseMethod] releaseId must be a number (".concat(e,")")));var r={};return t&&b.includes(t)&&(r.curr_abbr=t),this._fetch({uri:"/releases/".concat(e),query:r})},searchRelease:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return"string"!=typeof e?Promise.reject(new TypeError("[searchReleaseMethod] query must be a string (".concat(e,")"))):this.searchDatabase(c({},t,{query:e,type:"release"}),r)},getMaster:function(e){return"number"!=typeof e?Promise.reject(new TypeError("[getMasterMethod] masterId must be a number (".concat(e,")"))):this._fetch({uri:"/masters/".concat(e)})},getVersionsForMaster:function(e,t){return"number"!=typeof e?Promise.reject(new TypeError("[getVersionsForMasterMethod] masterId must be a number (".concat(e,")"))):this._fetch({uri:"/masters/".concat(e,"/versions"),query:T(t)})},getArtist:function(e){return"number"!=typeof e?Promise.reject(new TypeError("[getArtistMethod] artistId must be a number (".concat(e,")"))):this._fetch({uri:"/artists/".concat(e)})},getReleasesForArtist:function(e,t,r){return"number"!=typeof e?Promise.reject(new TypeError("[getReleasesForArtistMethod] artistId must be a number (".concat(e,")"))):this._fetch({uri:"/artists/".concat(e,"/releases"),query:c({},T(t),{},F(r,O))})},searchArtist:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return"string"!=typeof e?Promise.reject(new TypeError("[searchArtistMethod] query must be a string (".concat(e,")"))):this.searchDatabase(c({},t,{query:e,type:"artist"}),r)},getLabel:function(e){return"number"!=typeof e?Promise.reject(new TypeError("[getLabelMethod] labelId must be a number (".concat(e,")"))):this._fetch({uri:"/labels/".concat(e)})},getReleasesForLabel:function(e,t){return"number"!=typeof e?Promise.reject(new TypeError("[getReleasesForLabelMethod] labelId must be a number (".concat(e,")"))):this._fetch({uri:"/labels/".concat(e,"/releases"),query:T(t)})},searchLabel:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return"string"!=typeof e?Promise.reject(new TypeError("[searchLabelMethod] query must be a string (".concat(e,")"))):this.searchDatabase(c({},t,{query:e,type:"label"}),r)}}),L=["All","Deleted","Draft","Expired","For Sale","Sold","Suspended","Violation"],I=["listed","price","item","artist","label","catno","audio","status","location"];var D=["label","artist","title","catno","format","rating","year","added"];var S=["label","artist","title","catno","format","rating","year","added"];var q=Object.freeze({getInventory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.username,r=e.status,o=e.pagination,n=e.sort;if("string"!=typeof t)return Promise.reject(new TypeError("[getInventoryMethod] username must be a string (".concat(t,")")));var i={};return L.includes(r)&&(i.status=r),this._fetch({uri:"/users/".concat(t,"/inventory"),query:c({},i,{},F(n,I),{},T(o))})},getIdentity:function(){return this._fetch({uri:"/oauth/identity"})},getProfile:function(e){return"string"!=typeof e?Promise.reject(new TypeError("[getProfileMethod] username must be a string (".concat(e,")"))):this._fetch({uri:"/users/".concat(e)})},editProfile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.name,o=t.homepage,n=t.location,i=t.profile,s=t.currency;if("string"!=typeof e)return Promise.reject(new TypeError("[editProfileMethod] username must be a string (".concat(e,")")));var a={};if(r){if("string"!=typeof r)return Promise.reject(new TypeError("[editProfileMethod] name must be a string (".concat(r,")")));a.name=r}if(o){if("string"!=typeof o)return Promise.reject(new TypeError("[editProfileMethod] homepage must be a string (".concat(o,")")));a.home_page=o}if(n){if("string"!=typeof n)return Promise.reject(new TypeError("[editProfileMethod] location must be a string (".concat(n,")")));a.location=n}if(i){if("string"!=typeof i)return Promise.reject(new TypeError("[editProfileMethod] profile must be a string (".concat(i,")")));a.profile=i}if(s){if("string"!=typeof s||!b.includes(s))return Promise.reject(new TypeError("[editProfileMethod] currency must be one of '".concat(b.join(" / "),"' (").concat(s,")")));a.curr_abbr=s}return 0===Object.keys(a).length?Promise.reject(new Error("[editProfileMethod] data must be provided")):this._fetch({uri:"/users/".concat(e),options:{method:"POST",data:a}})},getSubmissionsForUser:function(e,t){return"string"!=typeof e?Promise.reject(new TypeError("[getSubmissionsForUserMethod] username must be a string (".concat(e,")"))):this._fetch({uri:"/users/".concat(e,"/submissions"),query:T(t)})},getContributionsForUser:function(e,t,r){return"string"!=typeof e?Promise.reject(new TypeError("[getContributionsForUserMethod] username must be a string (".concat(e,")"))):this._fetch({uri:"/users/".concat(e,"/contributions"),query:c({},T(t),{},F(r,D))})},listFoldersForUser:function(e){return"string"!=typeof e?Promise.reject(new TypeError("[listFoldersForUserMethod] username must be a string (".concat(e,")"))):this._fetch({uri:"/users/".concat(e,"/collection/folders")})},createFolderForUser:function(e,t){return"string"!=typeof e?Promise.reject(new TypeError("[createFolderForUserMethod] username must be a string (".concat(e,")"))):"string"!=typeof t?Promise.reject(new TypeError("[createFolderForUserMethod] name must be a string (".concat(t,")"))):this._fetch({uri:"/users/".concat(e,"/collection/folders"),options:{method:"POST",data:{username:e,name:t}}})},getFolderForUser:function(e,t){return"string"!=typeof e?Promise.reject(new TypeError("[getFolderForUserMethod] username must be a string (".concat(e,")"))):"number"!=typeof t?Promise.reject(new TypeError("[getFolderForUserMethod] folderId must be a number (".concat(t,")"))):this._fetch({uri:"/users/".concat(e,"/collection/folders/").concat(t)})},editFolderForUser:function(e,t,r){return"string"!=typeof e?Promise.reject(new TypeError("[editFolderForUserMethod] username must be a string (".concat(e,")"))):"number"!=typeof t?Promise.reject(new TypeError("[editFolderForUserMethod] folderId must be a number (".concat(t,")"))):"string"!=typeof r?Promise.reject(new TypeError("[editFolderForUserMethod] name must be a string (".concat(r,")"))):this._fetch({uri:"/users/".concat(e,"/collection/folders/").concat(t),options:{method:"POST",data:{name:r}}})},removeFolderForUser:function(e,t){return"string"!=typeof e?Promise.reject(new TypeError("[removeFolderForUserMethod] username must be a string (".concat(e,")"))):"number"!=typeof t?Promise.reject(new TypeError("[removeFolderForUserMethod] folderId must be a number (".concat(t,")"))):this._fetch({uri:"/users/".concat(e,"/collection/folders/").concat(t),options:{method:"DELETE"}})},getItemsInFolderForUser:function(e,t,r,o){return"string"!=typeof e?Promise.reject(new TypeError("[getItemsInFolderForUserMethod] username must be a string (".concat(e,")"))):"number"!=typeof t?Promise.reject(new TypeError("[getItemsInFolderForUserMethod] folderId must be a number (".concat(t,")"))):this._fetch({uri:"/users/".concat(e,"/collection/folders/").concat(t,"/releases"),query:c({},F(o,S),{},T(r))})},getCustomFields:function(e){return"string"!=typeof e?Promise.reject(new TypeError("[getCustomFieldsMethod] username must be a string (".concat(e,")"))):this._fetch({uri:"/users/".concat(e,"/collection/fields")})},getValue:function(e){return"string"!=typeof e?Promise.reject(new TypeError("[getValueMethod] username must be a string (".concat(e,")"))):this._fetch({uri:"/users/".concat(e,"/collection/value")})},getWantlist:function(e,t){return"string"!=typeof e?Promise.reject(new TypeError("[getWantlistMethod] username must be a string (".concat(e,")"))):this._fetch({uri:"/users/".concat(e,"/wants"),query:T(t)})},addToWantlist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.username,r=e.releaseId,o=e.notes,n=e.rating,i=void 0===n?0:n;if("string"!=typeof t)return Promise.reject(new TypeError("[addToWantlistMethod] username must be a string (".concat(t,")")));if("number"!=typeof r)return Promise.reject(new TypeError("[addToWantlistMethod] releaseId must be a number (".concat(r,")")));var s={};if(o){if("string"!=typeof o)return Promise.reject(new TypeError("[addToWantlistMethod] notes must be a string (".concat(o,")")));s.notes=o}return"number"!=typeof i?Promise.reject(new TypeError("[addToWantlistMethod] rating must be a number (".concat(i,")"))):(s.rating=i,this._fetch({uri:"/users/".concat(t,"/wants/").concat(r),options:{method:"PUT",data:s}}))},removeFromWantlist:function(e,t){return"string"!=typeof e?Promise.reject(new TypeError("[removeFromWantlistMethod] username must be a string (".concat(e,")"))):"number"!=typeof t?Promise.reject(new TypeError("[removeFromWantlistMethod] id must be a number (".concat(t,")"))):this._fetch({uri:"/users/".concat(e,"/wants/").concat(t),options:{method:"DELETE"}})},getListsForUser:function(e,t){return"string"!=typeof e?Promise.reject(new TypeError("[getListsForUserMethod] username must be a string (".concat(e,")"))):this._fetch({uri:"/users/".concat(e,"/lists"),query:T(t)})}});var C=Object.freeze({getItemsInList:function(e){return"number"!=typeof e?Promise.reject(new TypeError("[getItemsInListMethod] listId must be a number (".concat(e,")"))):this._fetch({uri:"/lists/".concat(e)})}});var U=["For Sale","Draft"];var R=["For Sale","Draft"];var k=["id","buyer","created","status","last_activity"];var A,G,x=Object.freeze({getListing:function(e,t){if("number"!=typeof e)return Promise.reject(new TypeError("[getListingMethod] listingId must be a number (".concat(e,")")));var r={};return t&&b.includes(t)&&(r.curr_abbr=t),this._fetch({uri:"/marketplace/listings/".concat(e),query:r})},editListing:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.releaseId,o=t.condition,n=(o=void 0===o?{}:o).release,i=o.sleeve,s=t.price,a=t.comments,c=t.allowOffers,u=void 0!==c&&c,f=t.status,m=void 0===f?U[0]:f,d=t.externalId,l=t.location,p=t.weight,h=void 0===p?"auto":p,y=t.formatQty,g=void 0===y?"auto":y,P=arguments.length>2?arguments[2]:void 0;if("number"!=typeof e)return Promise.reject(new TypeError("[editListingMethod] listingId must be a number (".concat(e,")")));var j={};if("number"!=typeof r)return Promise.reject(new TypeError("[editListingMethod] releaseId must be a number (".concat(r,")")));if(j.release_id=r,!w.includes(n))return Promise.reject(new TypeError("[editListingMethod] condition.release must be one of '".concat(w.join(" / "),"' (").concat(n,")")));if(j.condition=n,i){if(!v.includes(i))return Promise.reject(new TypeError("[editListingMethod] condition.sleeve must be one of '".concat(v.join(" / "),"' (").concat(i,")")));j.sleeve_condition=i}if("number"!=typeof s)return Promise.reject(new TypeError("[editListingMethod] price must be a number (".concat(s,")")));if(j.price=s,a){if("string"!=typeof a)return Promise.reject(new TypeError("[editListingMethod] comments must be a string (".concat(a,")")));j.comments=a}if("boolean"!=typeof u)return Promise.reject(new TypeError("[editListingMethod] allowOffers must be a boolean (".concat(u,")")));if(j.allow_offers=u,!U.includes(m))return Promise.reject(new TypeError("[editListingMethod] status must be one of '".concat(U.join(" / "),"' (").concat(m,")")));if(j.status=m,d){if("string"!=typeof d)return Promise.reject(new TypeError("[editListingMethod] externalId must be a string (".concat(d,")")));j.external_id=d}if(l){if("string"!=typeof l)return Promise.reject(new TypeError("[editListingMethod] location must be a string (".concat(l,")")));j.location=l}if("number"!=typeof h&&"auto"!==h)return Promise.reject(new TypeError("[editListingMethod] weight must be a number or 'auto' (".concat(h,")")));if(j.weight=h,"number"!=typeof g&&"auto"!==g)return Promise.reject(new TypeError("[editListingMethod] formatQty must be a number or 'auto' (".concat(g,")")));j.format_quantity=g;var T={};return P&&b.includes(P)&&(T.curr_abbr=P),this._fetch({uri:"/marketplace/listings/".concat(e),query:T,options:{method:"POST",data:j}})},removeListing:function(e){return"number"!=typeof e?Promise.reject(new TypeError("[removeListingMethod] listingId must be a number (".concat(e,")"))):this._fetch({uri:"/marketplace/listings/".concat(e),method:"DELETE"})},createListing:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.releaseId,r=e.condition,o=(r=void 0===r?{}:r).release,n=r.sleeve,i=e.price,s=e.comments,a=e.allowOffers,c=void 0!==a&&a,u=e.status,f=void 0===u?R[0]:u,m=e.externalId,d=e.location,l=e.weight,p=void 0===l?"auto":l,h=e.formatQty,y=void 0===h?"auto":h,g={};if("number"!=typeof t)return Promise.reject(new TypeError("[createListingMethod] releaseId must be a number (".concat(t,")")));if(g.release_id=t,!w.includes(o))return Promise.reject(new TypeError("[createListingMethod] condition.release must be one of '".concat(w.join(" / "),"' (").concat(o,")")));if(g.condition=o,n){if(!v.includes(n))return Promise.reject(new TypeError("[createListingMethod] condition.sleeve must be one of '".concat(v.join(" / "),"' (").concat(n,")")));g.sleeve_condition=n}if("number"!=typeof i)return Promise.reject(new TypeError("[createListingMethod] price must be a number (".concat(i,")")));if(g.price=i,s){if("string"!=typeof s)return Promise.reject(new TypeError("[createListingMethod] comments must be a string (".concat(s,")")));g.comments=s}if("boolean"!=typeof c)return Promise.reject(new TypeError("[createListingMethod] allowOffers must be a boolean (".concat(c,")")));if(g.allow_offers=c,!R.includes(f))return Promise.reject(new TypeError("[createListingMethod] status must be one of '".concat(R.join(" / "),"' (").concat(f,")")));if(g.status=f,m){if("string"!=typeof m)return Promise.reject(new TypeError("[createListingMethod] externalId must be a string (".concat(m,")")));g.external_id=m}if(d){if("string"!=typeof d)return Promise.reject(new TypeError("[createListingMethod] location must be a string (".concat(d,")")));g.location=d}return"number"!=typeof p&&"auto"!==p?Promise.reject(new TypeError("[createListingMethod] weight must be a number or 'auto' (".concat(p,")"))):(g.weight=p,"number"!=typeof y&&"auto"!==y?Promise.reject(new TypeError("[createListingMethod] formatQty must be a number or 'auto' (".concat(y,")"))):(g.format_quantity=y,this._fetch({uri:"/marketplace/listings",options:{method:"POST",data:g}})))},listOrders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,r=void 0===t?j[0]:t,o=e.pagination,n=e.sort,i=c({},T(o),{},F(n,k));return j.includes(r)?(i.status=r,this._fetch({uri:"/marketplace/orders",query:i})):Promise.reject(new TypeError("[listOrdersMethod] status must be one of '".concat(j.join(" / "),"' (").concat(r,")")))},getOrder:function(e){return"number"!=typeof e?Promise.reject(new TypeError("[getOrderMethod] orderId must be a number (".concat(e,")"))):this._fetch({uri:"/marketplace/orders/".concat(e)})},editOrder:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.status,o=t.shipping;if("number"!=typeof e)return Promise.reject(new TypeError("[editOrderMethod] orderId must be a number (".concat(e,")")));var n={};if(r){if(!P.includes(r))return Promise.reject(new TypeError("[editOrderMethod] status must be one of '".concat(P.join(" / "),"' (").concat(r,")")));n.status=r}if(o){if("number"!=typeof o)return Promise.reject(new TypeError("[editOrderMethod] shipping must be a string (".concat(o,")")));n.shipping=o}return 0===Object.keys(n).length?Promise.reject(new Error("[editOrderMethod] status or shipping must be provided")):this._fetch({uri:"/marketplace/orders/".concat(e),options:{method:"POST",data:n}})},listMessagesForOrder:function(e){return"number"!=typeof e?Promise.reject(new TypeError("[listMessagesForOrderMethod] orderId must be a number (".concat(e,")"))):this._fetch({uri:"/marketplace/orders/".concat(e,"/messages")})},sendMessageForOrder:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.message,o=t.status;if("number"!=typeof e)return Promise.reject(new TypeError("[sendMessageForOrderMethod] orderId must be a number (".concat(e,")")));var n={};if(!r&&!o)return Promise.reject(new Error("[sendMessageForOrderMethod] message or status must be present"));if(r){if("string"!=typeof r)return Promise.reject(new TypeError("[sendMessageForOrderMethod] message must be a string (".concat(r,")")));n.message=r}if(o){if(!j.includes(o))return Promise.reject(new TypeError("[sendMessageForOrderMethod] status must be one of '".concat(j.join(" / "),"' (").concat(o,")")));n.status=o}return this._fetch({uri:"/marketplace/orders/".concat(e,"/messages"),options:{method:"POST",data:n}})},getFee:function(e,t){if("number"!=typeof e)return Promise.reject(new TypeError("[getFeeMethod] price must be a number (".concat(e,")")));var r="/marketplace/fee/".concat(e);return t&&b.includes(t)&&(r+="/".concat(t)),this._fetch({uri:r})},getPriceSuggestions:function(e){return"number"!=typeof e?Promise.reject(new TypeError("[getPriceSuggestionsMethod] releaseId must be a number (".concat(e,")"))):this._fetch({uri:"/marketplace/price_suggestions/".concat(e)})}}),N="Discojs/".concat("1.3.2"),V=["discogs","plaintext","html"],W=V[0],B=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.userAgent,i=void 0===r?N:r,s=e.outputFormat,a=void 0===s?W:s,c=e.userToken,u=e.consumerKey,f=e.consumerSecret,m=e.requestLimit,d=void 0===m?25:m,l=e.requestLimitAuth,p=void 0===l?60:l,y=e.requestLimitInterval,g=void 0===y?6e4:y,b=e.fetchOptions;if(n(this,t),"string"!=typeof i)throw new TypeError("[Constructor] userAgent must be a string (".concat(i,")"));if(this.userAgent=i,"string"!=typeof a||!V.includes(a))throw new TypeError("[Constructor] outputFormat must be one of ".concat(V.join(" / ")," (").concat(a,")"));if(this.outputFormat=a,"number"!=typeof g)throw new TypeError("[Constructor] requestLimitInterval must be a number (".concat(g,")"));if(c||u&&f){if("number"!=typeof p)throw new TypeError("[Constructor] requestLimitAuth must be a number (".concat(p,")"));if(this.limiter=h({maxRequests:p,requestLimitInterval:g}),c){if("string"!=typeof c)throw new TypeError("[Constructor] userToken must be a string (".concat(c,")"));this.auth={level:2,userToken:c}}else{if("string"!=typeof u)throw new TypeError("[Constructor] consumerKey must be a string (".concat(u,")"));if("string"!=typeof f)throw new TypeError("[Constructor] consumerSecret must be a string (".concat(f,")"));this.auth={level:1,consumerKey:u,consumerSecret:f}}}else{if("number"!=typeof d)throw new TypeError("[Constructor] requestLimit must be a number (".concat(d,")"));this.limiter=h({maxRequests:d,requestLimitInterval:g})}if(b){if("object"!==o(b))throw new TypeError("[Constructor] fetchOptions must be an object (".concat(b,")"));this.fetchOptions=b}else this.fetchOptions={}}var s,a,u;return s=t,u=[{key:"getSupportedCurrencies",value:function(){return b}},{key:"getReleaseConditions",value:function(){return w}},{key:"getSleeveConditions",value:function(){return v}}],(a=[{key:"_fetch",value:function(t){var n=t.uri,i=t.query,s=t.options,a=void 0===s?{}:s,u=a.method,f=void 0===u?"GET":u,m=a.data,d=void 0===m?null:m,l=c({headers:{"User-Agent":this.userAgent,Accept:"application/vnd.discogs.".concat("v2",".").concat(this.outputFormat,"+json"),"Accept-Encoding":"gzip,deflate",Connection:"close","Content-Length":0}},this.fetchOptions,{method:f});if(d){var p=JSON.stringify(d);l.headers["Content-Type"]="application/json",l.headers["Content-Length"]=Buffer.byteLength(p,"utf8"),l.body=p}return this.auth&&(1===this.auth.level?l.headers.Authorization="Discogs key=".concat(this.auth.consumerKey,", secret=").concat(this.auth.consumerSecret):l.headers.Authorization="Discogs token=".concat(this.auth.userToken)),this.limiter.schedule(function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(o,n){return r(e,t).then(function(e){var t=e.status,r=e.statusText;return 401===t?n(new y):t<200||t>=300?n(new g({message:r,statusCode:t})):204===t?o({statusCode:t}):e.json().then(function(e){return o(e)}).catch(function(e){return n(e)})}).catch(function(e){return n(e)})})}(i&&"object"===o(i)?"".concat("https://api.discogs.com"+n,"?").concat(e(i)):"https://api.discogs.com"+n,l)})}}])&&i(s.prototype,a),u&&i(s,u),t}();A=c({},_,{},q,{},C,{},x),G=B,Object.keys(A).forEach(function(e){G.prototype[e]=A[e]});export default B;
